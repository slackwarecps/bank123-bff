[INFO] Scanning for projects...
[INFO] 
[INFO] -----------------< br.com.fabioalvaro.bank123:bffbank >-----------------
[INFO] Building bffbank 0.0.1-SNAPSHOT
[INFO] --------------------------------[ jar ]---------------------------------
[INFO] 
[INFO] >>> spring-boot-maven-plugin:3.5.8:run (default-cli) > test-compile @ bffbank >>>
[INFO] 
[INFO] --- maven-resources-plugin:3.3.1:resources (default-resources) @ bffbank ---
[INFO] Copying 2 resources from src/main/resources to target/classes
[INFO] Copying 2 resources from src/main/resources to target/classes
[INFO] 
[INFO] --- maven-compiler-plugin:3.14.1:compile (default-compile) @ bffbank ---
[INFO] Nothing to compile - all classes are up to date.
[INFO] 
[INFO] --- maven-resources-plugin:3.3.1:testResources (default-testResources) @ bffbank ---
[INFO] Copying 1 resource from src/test/resources to target/test-classes
[INFO] 
[INFO] --- maven-compiler-plugin:3.14.1:testCompile (default-testCompile) @ bffbank ---
[INFO] Nothing to compile - all classes are up to date.
[INFO] 
[INFO] <<< spring-boot-maven-plugin:3.5.8:run (default-cli) < test-compile @ bffbank <<<
[INFO] 
[INFO] 
[INFO] --- spring-boot-maven-plugin:3.5.8:run (default-cli) @ bffbank ---
[INFO] Attaching agents: []
Standard Commons Logging discovery in action with spring-jcl: please remove commons-logging.jar from classpath in order to avoid potential conflicts
10:20:31,574 |-WARN in ch.qos.logback.core.model.processor.ImplicitModelHandler - Ignoring unknown property [includeTimestamp] in [com.github.loki4j.logback.JsonLayout]
10:20:31,576 |-WARN in ch.qos.logback.core.model.processor.ImplicitModelHandler - Ignoring unknown property [includeMdc] in [com.github.loki4j.logback.JsonLayout]
10:20:31,576 |-WARN in ch.qos.logback.core.model.processor.ImplicitModelHandler - Ignoring unknown property [includeContext] in [com.github.loki4j.logback.JsonLayout]
10:20:31,576 |-WARN in ch.qos.logback.core.model.processor.ImplicitModelHandler - Ignoring unknown property [includeLoggerName] in [com.github.loki4j.logback.JsonLayout]
10:20:31,576 |-WARN in ch.qos.logback.core.model.processor.ImplicitModelHandler - Ignoring unknown property [includeMessage] in [com.github.loki4j.logback.JsonLayout]
10:20:31,576 |-WARN in ch.qos.logback.core.model.processor.ImplicitModelHandler - Ignoring unknown property [flattenMdc] in [com.github.loki4j.logback.JsonLayout]

  .   ____          _            __ _ _
 /\\ / ___'_ __ _ _(_)_ __  __ _ \ \ \ \
( ( )\___ | '_ | '_| | '_ \/ _` | \ \ \ \
 \\/  ___)| |_)| | | | | || (_| |  ) ) ) )
  '  |____| .__|_| |_|_| |_\__, | / / / /
 =========|_|==============|___/=/_/_/_/

 :: Spring Boot ::                (v3.5.8)

10:20:31.837 [main] INFO  b.c.f.b.bffbank.BffbankApplication - [trace= user=] Starting BffbankApplication using Java 17.0.7 with PID 5972 (/Users/fabioalvaropereira/workspaces/tcc/projeto-bank123/bank123-bff/target/classes started by fabioalvaropereira in /Users/fabioalvaropereira/workspaces/tcc/projeto-bank123/bank123-bff)
10:20:31.840 [main] INFO  b.c.f.b.bffbank.BffbankApplication - [trace= user=] The following 1 profile is active: "local"
10:20:33.110 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - [trace= user=] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
10:20:33.185 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - [trace= user=] Finished Spring Data repository scanning in 62 ms. Found 3 JPA repository interfaces.
10:20:33.783 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - [trace= user=] Tomcat initialized with port 8080 (http)
10:20:33.798 [main] INFO  o.a.coyote.http11.Http11NioProtocol - [trace= user=] Initializing ProtocolHandler ["http-nio-8080"]
10:20:33.800 [main] INFO  o.a.catalina.core.StandardService - [trace= user=] Starting service [Tomcat]
10:20:33.800 [main] INFO  o.a.catalina.core.StandardEngine - [trace= user=] Starting Servlet engine: [Apache Tomcat/10.1.49]
10:20:33.870 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - [trace= user=] Initializing Spring embedded WebApplicationContext
10:20:33.871 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - [trace= user=] Root WebApplicationContext: initialization completed in 1994 ms
Standard Commons Logging discovery in action with spring-jcl: please remove commons-logging.jar from classpath in order to avoid potential conflicts
10:20:34.164 [main] INFO  o.h.jpa.internal.util.LogHelper - [trace= user=] HHH000204: Processing PersistenceUnitInfo [name: default]
10:20:34.237 [main] INFO  org.hibernate.Version - [trace= user=] HHH000412: Hibernate ORM core version 6.6.36.Final
10:20:34.272 [main] INFO  o.h.c.i.RegionFactoryInitiator - [trace= user=] HHH000026: Second-level cache disabled
10:20:34.557 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - [trace= user=] No LoadTimeWeaver setup: ignoring JPA class transformer
10:20:34.587 [main] INFO  com.zaxxer.hikari.HikariDataSource - [trace= user=] HikariPool-1 - Starting...
10:20:34.846 [main] INFO  com.zaxxer.hikari.pool.HikariPool - [trace= user=] HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@3de383f7
10:20:34.848 [main] INFO  com.zaxxer.hikari.HikariDataSource - [trace= user=] HikariPool-1 - Start completed.
10:20:34.998 [main] INFO  o.hibernate.orm.connections.pooling - [trace= user=] HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 17.7
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
10:20:35.980 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - [trace= user=] HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
10:20:36.087 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - [trace= user=] Initialized JPA EntityManagerFactory for persistence unit 'default'
Carregando credenciais do Firebase via variável de ambiente FIREBASE_KEY_JSON.
Tamanho recebido: 3184
Início da string: ewogICJ0eX
Tentando decodificar Base64...
Credenciais decodificadas de Base64 com sucesso.
10:20:36.665 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - [trace= user=] spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
10:20:36.986 [main] INFO  o.s.b.a.e.web.EndpointLinksResolver - [trace= user=] Exposing 1 endpoint beneath base path '/actuator'
10:20:37.018 [main] WARN  o.s.b.a.s.s.UserDetailsServiceAutoConfiguration - [trace= user=] 

Using generated security password: 63f8918a-281e-4eac-870e-989d312b6c43

This generated password is for development use only. Your security configuration must be updated before running your application in production.

10:20:37.029 [main] INFO  o.s.s.c.a.a.c.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - [trace= user=] Global AuthenticationManager configured with UserDetailsService bean with name inMemoryUserDetailsManager
10:20:37.177 [main] INFO  o.s.v.b.OptionalValidatorFactoryBean - [trace= user=] Failed to set up a Bean Validation provider: jakarta.validation.NoProviderFoundException: Unable to create a Configuration, because no Jakarta Bean Validation provider could be found. Add a provider like Hibernate Validator (RI) to your classpath.
10:20:37.539 [main] INFO  o.a.coyote.http11.Http11NioProtocol - [trace= user=] Starting ProtocolHandler ["http-nio-8080"]
10:20:37.553 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - [trace= user=] Tomcat started on port 8080 (http) with context path '/'
10:20:37.573 [main] INFO  b.c.f.b.bffbank.BffbankApplication - [trace= user=] Started BffbankApplication in 6.472 seconds (process running for 6.853)
10:21:24.904 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - [trace= user=] Initializing Spring DispatcherServlet 'dispatcherServlet'
10:21:24.904 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - [trace= user=] Initializing Servlet 'dispatcherServlet'
10:21:24.906 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - [trace= user=] Completed initialization in 2 ms
10:21:24.955 [http-nio-8080-exec-1] INFO  b.c.f.b.bffbank.filter.MdcFilter - [trace=ccd4d1c9-e4ce-406a-84fb-c401e12f2edd user=] Nova request recebida: POST /comandos/v1/funcao-mudar-claim/123456 Headers: [host: localhost:8080 | user-agent: curl/8.7.1 | accept: */* | content-type: application/json | content-length: 39]
10:21:25.048 [http-nio-8080-exec-1] INFO  b.c.f.b.b.c.ComandosController - [trace=ccd4d1c9-e4ce-406a-84fb-c401e12f2edd user=] Recebida requisição para atualizar claims da conta: 123456 com UID: HL5dqdMBg5Wa01y073LJTzv87FS2
10:21:25.049 [http-nio-8080-exec-1] INFO  b.c.f.b.b.service.OnboardingService - [trace=ccd4d1c9-e4ce-406a-84fb-c401e12f2edd user=] Refazendo claims para a conta: 123456 com UID forçado: HL5dqdMBg5Wa01y073LJTzv87FS2
10:21:26.258 [http-nio-8080-exec-1] INFO  b.c.f.b.b.service.OnboardingService - [trace=ccd4d1c9-e4ce-406a-84fb-c401e12f2edd user=] Custom claims adicionadas ao usuário HL5dqdMBg5Wa01y073LJTzv87FS2: {bank123/jwt/claims={allowed_roles=[cliente_pf], numeroconta=123456, scope=read:saldo read:extrato write:transacoes read:perfil, default_role=cliente_pf}}
[INFO] ------------------------------------------------------------------------
[INFO] BUILD FAILURE
[INFO] ------------------------------------------------------------------------
[INFO] Total time:  10:15 min
[INFO] Finished at: 2025-12-21T10:30:43-03:00
[INFO] ------------------------------------------------------------------------
[ERROR] Failed to execute goal org.springframework.boot:spring-boot-maven-plugin:3.5.8:run (default-cli) on project bffbank: Process terminated with exit code: 137 -> [Help 1]
[ERROR] 
[ERROR] To see the full stack trace of the errors, re-run Maven with the -e switch.
[ERROR] Re-run Maven using the -X switch to enable full debug logging.
[ERROR] 
[ERROR] For more information about the errors and possible solutions, please read the following articles:
[ERROR] [Help 1] http://cwiki.apache.org/confluence/display/MAVEN/MojoExecutionException
